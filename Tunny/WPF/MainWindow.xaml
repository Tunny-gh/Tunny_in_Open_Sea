<RibbonWindow
    x:Class="Tunny.WPF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:common="clr-namespace:Tunny.WPF.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="clr-namespace:Tunny.WPF.ViewModels"
    Title="Tunny"
    Width="1000"
    Height="850"
    Background="#FF93C6F8"
    Icon="Assets/Icon/Tunny.png"
    ResizeMode="CanMinimize"
    mc:Ignorable="d">
    <Window.DataContext>
        <viewModels:MainWindowViewModel />
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="AUTO" />
            <RowDefinition Height="*" />
            <RowDefinition Height="AUTO" />
        </Grid.RowDefinitions>

        <Ribbon x:Name="Ribbon" Grid.Row="0">
            <Ribbon.HelpPaneContent>
                <RibbonButton
                    Click="TunnyDocumentHelpButton_Click"
                    SmallImageSource="Assets/Icon/HelpBox.png"
                    ToolTip="Context Help" />
            </Ribbon.HelpPaneContent>

            <Ribbon.QuickAccessToolBar>
                <RibbonQuickAccessToolBar>
                    <RibbonButton
                        Click="QuickAccessFileOpenRibbonButton_Click"
                        SmallImageSource="Assets/Icon/FolderOpenOutline.png"
                        ToolTip="Open Optimization Result File" />
                    <RibbonButton
                        Click="QuickAccessFileSaveRibbonButton_Click"
                        SmallImageSource="Assets/Icon/ContentSave.png"
                        ToolTip="Override Save Settings" />
                </RibbonQuickAccessToolBar>
            </Ribbon.QuickAccessToolBar>

            <RibbonTab Header="Optimize">
                <RibbonGroup>
                    <RibbonButton
                        Command="{Binding SelectSamplerCommand}"
                        CommandParameter="{x:Static common:EnumSamplerType.Auto}"
                        Label="AUTO Sampler"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Bayesian Optimization">
                    <RibbonButton
                        Command="{Binding TpeSamplerCommand}"
                        Label="TPE"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding GpOptunaSamplerCommand}"
                        IsEnabled="{Binding IsSingleObjective}"
                        Label="GP:Optuna"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding GpBotorchCommand}"
                        Label="GP:BoTorch"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding GpPreferentialCommand}"
                        IsEnabled="False"
                        Label="GP:Preferential"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Genetic Algorighm">
                    <RibbonButton
                        Command="{Binding NsgaiiSamplerCommand}"
                        Label="NSGA-II"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding NsgaiiiSamplerCommand}"
                        Label="NSGA-III"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Evolution Strategy">
                    <RibbonButton
                        Command="{Binding CmaEsSamplerCommand}"
                        IsEnabled="{Binding IsSingleObjective}"
                        Label="CMA-ES"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding MoCmaEsSamplerCommand}"
                        IsEnabled="{Binding IsMultiObjective}"
                        Label="MO-CMA-ES"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Evolution Algorithm">
                    <RibbonButton
                        Command="{Binding MoeadSamplerCommand}"
                        IsEnabled="{Binding IsMultiObjective}"
                        Label="MOEA/D"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Misc">
                    <RibbonButton
                        Command="{Binding RandomSamplerCommand}"
                        Label="Random"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding QmcSamplerCommand}"
                        Label="QMC"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding BruteForceSamplerCommand}"
                        Label="BruteForce"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Optuna Hub">
                    <RibbonButton
                        Command="{Binding RegisterOptunaHubSamplerCommand}"
                        Label="Register Sampler"
                        LargeImageSource="Assets/Icon/Optuna.png"
                        SmallImageSource="Assets/Icon/Optuna.png" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Visualize">
                <RibbonGroup Header="Browser">
                    <RibbonButton
                        Click="VisualizeRunOptunaDashboardRibbonButton_Click"
                        Label="Optuna Dashboard"
                        LargeImageSource="Assets/Icon/Optuna.png"
                        SmallImageSource="Assets/Icon/Optuna.png" />
                    <RibbonButton
                        Click="VisualizeRunDesignExplorerRibbonButton_Click"
                        Label="TT Design Explorer"
                        LargeImageSource="Assets/Icon/DesignExplorer.png"
                        SmallImageSource="Assets/Icon/DesignExplorer.png" />
                </RibbonGroup>
                <RibbonGroup Header="Optuna Visualization">
                    <RibbonButton
                        Command="{Binding PlotParetoFrontCommand}"
                        Label="Pareto Front"
                        LargeImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotHistoryCommand}"
                        Label="History"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotSliceCommand}"
                        Label="Slice"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotContourCommand}"
                        Label="Contour"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotParameterImportanceCommand}"
                        Label="Param Importance"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotParallelCoordinateCommand}"
                        Label="Parallel Coordinate"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotHyperVolumeCommand}"
                        Label="Hyper volume"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotEdfCommand}"
                        Label="EDF"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotRankCommand}"
                        Label="Rank"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotTimelineCommand}"
                        Label="Timeline"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Command="{Binding PlotTerminatorImprovementCommand}"
                        Label="Terminator Improvement"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Optuna Hub">
                    <RibbonButton Label="Register Plot" LargeImageSource="Assets/Icon/Optuna.png" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Output">
                <RibbonGroup Header="Target">
                    <RibbonComboBox />
                </RibbonGroup>
                <RibbonGroup Header="Group Output">
                    <RibbonButton Label="Pareto Solutions" LargeImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton Label="All Trials" LargeImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Use Trial Numbers Output">
                    <RibbonTextBox Label="Trial Numbers" />
                    <RibbonButton Label="Reinstate to Slider" LargeImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton Label="Output to Component" LargeImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Misc">
                <RibbonGroup Header="Pruner">
                    <RibbonButton
                        Label="Median"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Nop"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Patient"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Successive Halving"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Hyperband"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Threshold"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Wilcoxon"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Termination">
                    <RibbonButton
                        Label="Regret Bound"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="BestValue Stagnation"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="EMMR"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Static Error"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Label="Median Error"
                        LargeImageSource="Assets/Icon/Tunny.png"
                        SmallImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
            </RibbonTab>

            <RibbonTab Header="Help">
                <RibbonGroup>
                    <RibbonButton
                        Click="TunnyAboutButton_Click"
                        Label="About"
                        LargeImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>
                <RibbonGroup Header="Help Pages">
                    <RibbonButton
                        Click="TunnyDocumentHelpButton_Click"
                        Label="Tunny"
                        LargeImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Click="OptunaSamplerHelpButton_Click"
                        Label="Optuna Sampler"
                        LargeImageSource="Assets/Icon/Optuna.png" />
                    <RibbonButton
                        Click="OptunaHubHelpButton_Click"
                        Label="Optuna Hub"
                        LargeImageSource="Assets/Icon/Optuna.png" />
                </RibbonGroup>
                <RibbonGroup Header="License">
                    <RibbonButton
                        Click="TunnyLicenseHelpButton_Click"
                        Label="Tunny"
                        LargeImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Click="PythonPackagesLicenseHelpButton_Click"
                        Label="Python Packages"
                        LargeImageSource="Assets/Icon/Tunny.png" />
                    <RibbonButton
                        Click="OtherLicenseHelpButton_Click"
                        Label="Others"
                        LargeImageSource="Assets/Icon/Tunny.png" />
                </RibbonGroup>

            </RibbonTab>
        </Ribbon>

        <Frame
            Grid.Row="1"
            Background="AliceBlue"
            Content="{Binding MainFrameWindow}"
            NavigationUIVisibility="Hidden" />

        <StatusBar Grid.Row="2" Background="#FF93C6F8">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="5*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="300" />
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            <StatusBarItem>
                <Label x:Name="StatusBarLabel" Content="Ready" />
            </StatusBarItem>
            <Separator Grid.Column="1" />
            <StatusBarItem x:Name="StatusBarTrialNumberLabel" Grid.Column="2">
                <Label Content="Trial: #" />
            </StatusBarItem>
            <StatusBarItem x:Name="StatuBarETALabel" Grid.Column="3">
                <Label Content="ETA: #" />
            </StatusBarItem>
            <Separator Grid.Column="4" />
            <StatusBarItem Grid.Column="5">
                <ProgressBar
                    x:Name="StatusBarProgressBar"
                    Width="300"
                    Height="15"
                    Maximum="100"
                    Minimum="0"
                    Value="0" />
            </StatusBarItem>
        </StatusBar>
    </Grid>
</RibbonWindow>
